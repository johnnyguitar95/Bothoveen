var ep = window.ep || {}; ep.bundles = ep.bundles || []; ep.bundles = ep.bundles.concat('bundled/notesmodal.js','ep/notedialog.js', 'ep/webservices/common.js', 'ep/webservices/folderwebservice.js');
ep.registerInstance("ep.NoteDialog");ep.NoteDialog=(function(aA){var bi="invalid_page_selection";var ay,aw,aR,aC,bh;var aF,aW,aX,aB,bq,ax,a0;var aH,a6,aN,aq,at,bk,an,bo,bg,aP,aO;function aD(a){ep.debug("ep/notedialog.js -> _initialize");aA(".note-text-area").epeditor();a7();aZ(a);be();bp();if(ep.Viewer){aA("#contextCitation").html(aS());aA(document).unbind("keydown",ep.Viewer.keyDownHandler)}bc();aA(window).on("editorIntervalCheck",ep.NoteDialog.onEditorChange)}function aG(d,e,f,a){ep.debug("ep/notedialog.js -> _getNoteData");var g={noteID:d,isPostBack:e,isInViewer:f,thePostBackElem:a};var b=aE();var c=ba;EPWebServices.FolderWebService.FolderReadNote(b,g,c,null,null)}function aZ(a){ep.debug("ep/notedialog.js -> _parseReadNoteArgs");if(a){if(a.readnote){aH=a.readnote}if(a.noteDoPostBack){aq=a.noteDoPostBack}if(a.notePostBackElem){at=a.notePostBackElem}if(a.noteIsInViewer){bk=a.noteIsInViewer}if(a.noteID){bq=a.noteID;aA("#readNoteId").val(bq);aG(bq,aq,bk,at)}aT()}else{aH=false;aq=false;if(ep.Viewer){aV()}}}function a7(){ep.debug("ep/notedialog.js -> _clearGlobalVars");ay=aw=aR=aC=bh=null;aB=bq=ax=a0=bo=at=null;bg=aP=aF=aW=aX=null;aq=bk=a6=aO=aH=false}function be(){ep.debug("ep/notedialog.js -> _setupNoteEmail");if(aH&&aH==="true"){var a=aA("#emailFrame");if(!a){a=aA("<iframe>").attr({id:"emailFrame",height:"0",width:"0","class":"hidden"});document.body.appendChild(a[0])}}}function bp(){ep.debug("ep/notedialog.js -> _setupNoteDialogDisplay");if(aH&&aH==="true"){ep.debug("ep/notedialog.js -> _setupNoteDialogDisplay -> _readNote!!");aA("#editBtn,#deleteBtn,#closeBtn,#notesReadSection").css({display:""});aA("#cancelBtn").css({display:"none"});aA("#notesEntrySection").css({display:"none"})}else{ep.debug("ep/notedialog.js -> _setupNoteDialogDisplay -> NOT _readNote!!");aA("#readTitleSpan,#contentLinkLabel,#notesReadSection,#notesLastEdited").css({display:"none"});aA("#createTitleSpan,#saveBtn").css({display:""})}}function aJ(a){ep.debug("ep/notedialog.js -> _stripBadMarkupText");var b=/<a[^>]+>/;var c=b.exec(a);if(c!==null){return[a.substring(0,c.index),aJ(a.substring(c.index+c[0].length))].join("")}else{var d=a.indexOf("</a>");if(d!==-1){return[a.substring(0,d),aJ(a.substring(d+4))].join("")}else{return a}}}function aT(){ep.debug("ep/notedialog.js -> _setupEditBtnClick");var a=aA("#mainModalContent").parent().parent().parent();aA("#editBtn").removeAttr("onclick").click(function(){aA(a).fadeOut("normal",function(){aA("#readTitleSpan,#contentLinkLabel,#editBtn,#closeBtn,#notesReadSection,#showDelivery").css({display:"none",visibility:"hidden"});aA("#editTitleSpan,#updateBtn,#cancelBtn").css({display:""});ep.NoteDialog.hidePrintOptions();aA(a).fadeIn("normal",bc);var b=aA("#noteTextSetup").html();b=["<div>",b,"</div>"].join("");aA(".note-text-area").val(b);aA("#notesEntrySection").css({display:""})});az(aA("#saveBtn"),false);az(aA("#updateBtn"),false)})}function bj(b){ep.debug("ep/notedialog.js -> _linkMarkupText");var a=/[hH][tT][tT][pP][sS]?\:\/\/[^<\s]+/;var d=a.exec(b);if(d!==null){var c=[];c.push(b.substring(0,d.index),'<a href="',d);c.push('" onclick="window.open(this.href); return false;">',d,"</a>");c.push(bj(b.substring(d.index+d[0].length)));return c.join("")}else{return b}}function bc(){ep.debug("ep/notedialog.js -> _initializeDraggable");var a=aA("#mainModalContent").parent().parent().parent().parent();a.attr("id","modal_draggable");return aA(a).draggable({zIndex:10001,scroll:false,containment:aA(document.documentElement)})}function bd(b,g,e,c,a,d,f){ep.debug("ep/notedialog.js -> _setCurrentCitation");an={database:b,an:g,uitag:"AN",title:e,doid:c,plink:a,pubdate:d,segid:f}}function aS(){ep.debug("ep/notedialog.js -> _buildCitationFromViewerState");if(ep.Viewer&&!ay){aV()}var c=ay.StateManager.getProperty("twPV")?[ay.imageData.label,ay.oImageData.label].join(" - "):aR.label;var d=[];var a=aw.isMonograph?aw.publicationYear:aw.publicationDate;var b=ay.articleData?ay.articleData.pages:[];if(aw.isMonograph){d.push('<p>"',ep.URLDecode(aw.title),'"</p><br />')}else{if(ay.articleId&&ay.articleId!=="NA"){d.push('<p>"',ay.articleData.title,'"</p><br />')}}if(!aw.isMonograph&&ay.articleData&&ay.articleData.author&&ay.articleData.author!==""){d.push("By: ",ep.URLDecode(ay.articleData.author));d.push(ep.URLDecode(ay.articleData.author).charAt(ep.URLDecode(ay.articleData.author).length-1)!=="."?". ":" ")}else{if(aw.isMonograph&&aw.authors&&aw.authors!==""){d.push("By: ",ep.URLDecode(aw.authors));d.push(ep.URLDecode(aw.authors).charAt(ep.URLDecode(aw.authors).length-1)!=="."?". ":" ")}}if(!aw.isMonograph){d.push("<i>",ep.URLDecode(aw.title),"</i>, ")}d.push(a);if(!aw.isMonograph){d.push(" ,");if(aw.volume!==""){d.push(" Vol. ",aw.volume)}if(aw.issue!==""){d.push(" Issue ",aw.issue)}if(b.length>1){d.push(", p",aw.pageData[_.first(b)].label,"-",aw.pageData[_.last(b)].label,", ",b.length,"p;")}else{if(ay.articleId&&ay.articleId!=="NA"){d.push(", p",aR.label)}}}d.push("<br />");if(!aw.isMonograph&&ay.articleId&&ay.articleId!=="NA"&&ay.articleData&&ay.articleData.an!==null){d.push("(AN ",ay.articleData.an,")")}else{if(aw.isMonograph){d.push("(AN ",aw.an,")")}}d.push("<br /><br />Page  ",c);return d.join("")}function aE(){return{sessionID:document.getElementById("__sid").value,sessionVId:document.getElementById("__vid").value}}function aL(a){ep.debug("ep/notedialog.js -> _saveNoteFormValidation");var b,c;b=aA(".note-text-area").val();if(b.length<=4000){a6=true;c=b;bb(a,c);if(!aO){if(false){aA("#saveBtn").form.dialog.hide()}else{aA("#cancelBtn").click()}}return false}else{if(aO){bf()}else{ep.NoteDialog.onEditorChange()}return false}}function bb(a,e){ep.debug("ep/notedialog.js -> _saveNote");var b,h,f,d;e=bj(aJ(e));if(ep.Viewer){if(aw.isMonograph){b=aw.tag;h=aw.an;f=aw.title}else{if(ay.articleData){b=ay.articleData.tag;h=ay.articleData.an;f=ay.articleData.title}else{b=aw.tag;h=aw.an;f=aw.title}}var c=aR.label,j=ay.imageData.id;if(ay.oImageData){c=[ay.imageData.label,ay.oImageData.label].join(" - ");j=ay.oImageData.id}d={database:aw.db,an:h,uitag:"AN",title:f,doid:aw.id,notecontent:e,pageid:aR.id,imageid:aR.imageId,plink:aw.pLink,pubdate:aw.isMonograph?aw.publicationYear:aw.publicationDate,pageLabel:c,istwopage:ay.oImageData?true:false,segid:aw.isMonograph?null:ay.articleId};if(bh){aC.noteText=aA(".note-text-area").val();aC.isInNotes=true}else{aR.noteText=aA(".note-text-area").val();aR.isInNotes=true}}else{an.notecontent=e;d=an;bh=true}var i=bg!==null?bg:aE();var g={IsAdd:true,IsEdit:false};var l=ep.Viewer?true:false;var k=aO?a2:a8;ep.debug("_saveNote(): calling web service...");ep.debug("	aParams = "+JSON.stringify(i));ep.debug("	aContentItem = "+JSON.stringify(d));ep.debug("	isRefreshHtml = "+JSON.stringify(a));ep.debug("	_isArticleNote = "+JSON.stringify(bh));ep.debug("	isUpdateInViewer = "+JSON.stringify(l));ep.debug("	aCallBackMethod = "+JSON.stringify(aO?"_popupClose":"_onNoteAddRemove"));ep.debug("	aCallbackParams = "+JSON.stringify(g));EPWebServices.FolderWebService.FolderPageNoteAdd(i,d,a,bh,l,k,null,g)}function aY(c){ep.debug("ep/notedialog.js -> _deleteNote");a6=true;var d={noteID:bq?bq:null};var f=aE();var a={IsAdd:false,IsEdit:false};var e=ep.Viewer?true:false;var b=aq===true?false:c;EPWebServices.FolderWebService.FolderPageNoteDelete(f,d,b,e,a8,null,a);if(aq===false){if(false){aA("#deleteBtn").form.dialog.hide()}else{aA("#cancelBtn").click()}}}function a9(a){ep.debug("ep/notedialog.js -> _updateNoteFormValidation");var b,c;b=aA(".note-text-area").val();if(b.length<=4000){a6=true;c=b;bl(a,c);if(aq===false){if(false){aA("#updateBtn").form.dialog.hide()}else{aA("#cancelBtn").click()}}return false}else{ep.NoteDialog.onEditorChange();return false}}function bl(b,c){ep.debug("ep/notedialog.js -> _updateNote");c=aJ(c);c=bj(c);var d={notecontent:c,noteID:bq?bq:null};var f=aE();var g={IsAdd:false,IsEdit:true};var e=ep.Viewer?true:false;var a=aq===true?false:b;EPWebServices.FolderWebService.FolderPageNoteUpdate(f,d,a,e,a8,null,g)}function a5(){ep.debug("ep/notedialog.js -> _hideAndPostBack");if(false){aA("#updateBtn").form.dialog.hide()}else{aA("#updateBtn").closest("form").hide();aA(".modal-dialog .ui-icon-closethick").click()}aA("#doPostBackBtn").click()}function aM(){return aq===true&&a6===true?true:false}function a8(c,a){ep.debug("ep/notedialog.js -> _onNoteAddRemove");if(aq===true){a5()}else{if(c){aA("#folderItemsContainerControl").html(c)}if(a.IsEdit){if(ep.folder.updateToolbarFolderControl){ep.folder.updateToolbarFolderControl()}}else{if(ep.controller.control.FolderItemsControl){ep.controller.control.FolderItemsControl.updateFolderCount(a.IsAdd)}else{if(ep.folder.updateToolbarFolderCount){ep.folder.updateToolbarFolderCount(a.IsAdd)}}}if(ep.Viewer){ep.debug("ep.NoteDialog._onNoteAddRemove(): firing NoteDialog:ItemAddRemove");ep.publish("NoteDialog:ItemAddRemove",a.IsAdd)}else{var b=aA(".addNote");aA(b).each(function(e,d){if(a.IsAdd===true||aA("#folderNotesGoTo").length){aA(d).addClass("hasNotes")}else{aA(d).removeClass("hasNotes")}})}}}function ba(d,c){ep.debug("ep/notedialog.js -> _onNoteRead");var a=aA.parseJSON(d);var b=aA("#contextCitation");if(b.html()===""){b.html(a.NoteContext)}aF=a.NoteText;aB=a.NoteLink;aW=a.DateModified;if(aF){aA("#noteTextSetup").html(ep.URLDecode(aF));aA("#notesTextDisplay").html(ep.URLDecode(aF))}if(aB){aA("#contextLink").attr("href",aB)}if(a.isEbook&&a.ebookJson){aA("#contextLink").attr("data-ebook",a.ebookJson);aA("#contextLink").attr("class","ebook-ft")}if(aW){aA("#notesLastEdited").html(["Last edited:",aW].join(" "))}bc()}function aV(){ep.debug("ep/notedialog.js -> _getDataFromViewer");ay=ep.Viewer;aw=ay.DataManager.data;if(ay.imageData){if(!ay.imageData.isDummy&&ay.imageData.type!=="DUMMY"){aR=ay.imageData}else{aR=ay.oImageData}}else{if(ay.oImageData){aR=ay.oImageData}}if(ay.articleId===null||ay.articleId==="NA"||aw.isMonograph){bh=false;aC={isInNotes:false,noteText:""}}else{bh=true;aC=aw.contents[ay.articleId]}}aA.fn.cleanWhitespace=function(){textNodes=this.contents().filter(function(){return(this.nodeType===3&&!/\S/.test(this.nodeValue))}).remove();return this};function a4(){ep.debug("ep/notedialog.js -> _showPrintOptions");aA(".notes-modal-dialog").first().width("715px");var a=aA("#printEmailOptions").cleanWhitespace();aA(a).css("display","");aA("#showDelivery").css("display","none");aA("#hideDelivery").css("display","");a1();bc()}function aU(){ep.debug("ep/notedialog.js -> _hidePrintOptions");aA(".notes-modal-dialog").first().width("415px");var a=aA("#printEmailOptions").cleanWhitespace();aA(a).css("display","none");aA("#showDelivery").css("display","");aA("#hideDelivery").css("display","none");bc()}function aK(){aq=true;a6=true}function a3(){ep.debug("ep/notedialog.js -> _emailNote");if(ap()){aq=false;a6=false;if(bq){var a={citationFormat:aA("#citationFormatSelect").val(),to:aA("#emailTo").val(),from:aA("#emailFrom").val(),subject:aA("#emailSubject").val(),noteId:bq};au(a);if(false){aA("#emailBtn").form.dialog.hide()}else{aA("#emailBtn").closest("form")[0].hide();aA(".modal-dialog .ui-icon-closethick").click()}return false}}else{return false}}function au(c){ep.debug("ep/notedialog.js -> _sendNoteEmail");var b="emailnote"+ep.NoteDialog.rootQuery;var d=aA("#emailFrame");if(d&&d.length){var a=d.contentDocument;if(!a&&d.contentWindow){a=d.contentWindow.document}a.open("text/html",true);a.writeln("<html><body>");a.writeln('<form id="emailForm" method="post"><textarea name="data"></textarea></form>');a.writeln("</body></html>");a.close();var e=a.getElementById("emailForm");e.action=b;e.elements[0].value=JSON.stringify(c);e.submit()}}function ap(){ep.debug("ep/notedialog.js -> _validEmailCheck");var g=aA("#emailTo").val();var e=aA("#emailFrom");var a=aA(e).val();var c=aA(e).attr("disabled");var b=aA("#invalidEmailPlaceholder").html();var f=aA("#invalidEmailWarning");var h=aA("#emailBtn");var i=null;var d=/^([\w-\.]+)@([a-zA-Z0-9_\-]+\.)+[a-zA-Z0-9_\-\.]+/;i=d.exec(g);if(i===null||i[0]!==g){aA(f).html(g+b);aA(f).css("display","");az(h,true);return false}if(c){return true}i=d.exec(a);if(i===null||i[0]!==a){aA(ErrorSpan).html(a+b);aA(f).css("display","");az(h,true);return false}return true}function bm(a){switch(a){case"<br />":return true;case"<p />":return true;case"<div />":return true;case"<div><div /></div>":return true;case"<div><div><div /></div></div>":return true;case"<div><div><br /></div></div>":return true;case"<div><br /></div>":return true;case"<div><p /></div>":return true;case'<br _moz_editor_bogus_node="TRUE" />':return true}if(a.length<=0){return true}else{if(a.length>=4000){return true}else{return false}}}function aI(a,b,c,d){ep.debug("ep/notedialog.js -> _popupNoteSetup");aO=true;bo=aA("#"+a);bg={sessionID:c,sessionVId:d};aP=aA("#"+b)}function bf(){ep.debug("ep/notedialog.js -> _popupOnEditorChange");var a=aA(".note-text-area").val();if(a.length>4000){aP.css("display","")}else{aP.css("display","none")}az(bo,bm(a))}function ar(){ep.debug("ep/notedialog.js -> _onEditorChange");if(aA(".note-text-area").length){var b=aA(".note-text-area").val();if(b.length>4000){aA("#maxLengthWarning").css("display","")}else{aA("#maxLengthWarning").css("display","none")}var a=bm(b);az(aA("#saveBtn"),a);az(aA("#updateBtn"),a)}}function az(a,b){if(b){aA(a).attr("disabled",true);aA(a).addClass("notes-footer-disabled");aA(a).removeClass("primary-action")}else{aA(a).attr("disabled",false);aA(a).removeClass("notes-footer-disabled");aA(a).addClass("primary-action")}}function av(a){var b=a.keyCode?a.keyCode:a.which;if(b===13){a.returnValue=false;a.cancel=true;if(a.stopPropagation){a.stopPropagation()}}}function a1(){ep.debug("ep/notedialog.js -> _onEmailChange");var a=aA("#emailBtn");if(aA("#emailTo").val()!==""&&aA("#emailFrom").val()!==""){az(a,false);aA("#invalidEmailWarning").css({display:"none"})}else{az(a,true)}}function bn(b,a,g,d,e){ep.debug("ep/notedialog.js -> _readNoteSetup");var f={readnote:"true",noteID:b,noteIsInViewer:d,noteDoPostBack:g,notePostBackElem:a};var c=new ep.dialog.ModalDialog(e,{command:"createnote",onRender:function(){ep.NoteDialog.initialize(f)},onHide:ep.NoteDialog.hide,onSubmit:ep.addModalRedirectParameter,titleElement:"#modalDialog%20.header",cssClass:"notes-modal-dialog",screenOpacity:"0.4",onClientAfterHide:ep.NoteDialog.destroyWidget});c.show()}function aQ(){ep.debug("ep/notedialog.js -> _hide");if(ep.Viewer){aA(document).on("keydown",ep.Viewer.keyDownHandler)}aA(window).off("editorIntervalCheck",ep.NoteDialog.onEditorChange)}function ao(){ep.debug("ep/notedialog.js -> _destroyWidget");aA(".note-text-area").epeditor("destroy")}function a2(){ep.debug("ep.NoteDialog._popupClose()!");window.close()}return{initialize:function(a){aD(a)},saveNote:function(a){aL(a)},updateNote:function(a){a9(a)},deleteNote:function(a){aY(a)},hide:function(){aQ()},destroyWidget:function(){ao()},onEditorChange:function(){ar()},isPostBack:function(){return aM()},showPrintOptions:function(){a4()},hidePrintOptions:function(){aU()},setCurrentCitation:function(b,g,e,c,a,d,f){bd(b,g,e,c,a,d,f)},popupNoteSetup:function(a,b,c,d){aI(a,b,c,d)},popupOnEditorChange:function(){bf()},printNote:function(){aK()},emailNote:function(){return a3()},onEmailChange:function(){a1()},blockTitleSubmit:function(a){av(a)},popupClose:function(){a2()},readNote:function(c,b,d,a,e){bn(c,b,d,a,e)}}})(jQuery);(function(b){if(window.EPWebServices===undefined){window.EPWebServices={}}EPWebServices.buildURL=function(h,f){h=h.replace(/^\//,"");f=f.replace(/^\//,"");var a=(this._getHid()!==null)?"?hid="+this._getHid():"";var g=location.href.split("/"+ep.interfaceId+"/")[0]+"/"+h+"/"+f+a;return g};EPWebServices.doWebServiceCall=function(h,i,k,j,l){ep.debug("ep/webservices/common.js -> doWebServiceCall");var a=b.ajax(h,{type:"POST",contentType:"application/json",data:JSON.stringify(i),dataType:"text",success:function(c,d,g){var n;var e=g.getResponseHeader("content-type")||"";if(e.indexOf("json")>-1){var f=b.parseJSON(c);if(f!==null){n=f.d}}else{n=c}if(k){k(n,l)}},error:function(e,c,d){ep.debug("ajax error : "+d);if(j){j(transport.responseText,l)}}})};EPWebServices._getHid=function(){var a=window.location.toString().match(/hid=(\d+)/);if(a!==null&&a.length>1){return a[1]}else{return null}}})(jQuery);EPWebServices.FolderWebService={};EPWebServices.FolderWebService._SERVICE_URL="/Legacy/Views/WebServices/FolderWebService.asmx";EPWebServices.FolderWebService.FolderPageAddRemove=function(k,m,q,n,o,p,j){var l=EPWebServices.buildURL(this._SERVICE_URL,"FolderPageAddRemove");var r={theSessionParams:k,theContentItem:m,theIsAdd:q,theIsRefreshFolderItems:n};EPWebServices.doWebServiceCall(l,r,o,p,j)};EPWebServices.FolderWebService.FolderItemsAddRemove=function(k,m,q,n,o,p,j){var l=EPWebServices.buildURL(this._SERVICE_URL,"FolderItemsAddRemove");var r={theSessionParams:k,theContentItem:m,theIsAdd:q,theIsRefreshFolderItems:n};EPWebServices.doWebServiceCall(l,r,o,p,j)};EPWebServices.FolderWebService.DAFolderItemsAddRemove=function(k,m,q,n,o,p,j){var l=EPWebServices.buildURL(this._SERVICE_URL,"DAFolderItemsAddRemove");var r={theSessionParams:k,theContentItem:m,theIsAdd:q,theIsRefreshFolderItems:n};EPWebServices.doWebServiceCall(l,r,o,p,j)};EPWebServices.FolderWebService.AddExternalFolderItems=function(g,j,i,l){var h=EPWebServices.buildURL(this._SERVICE_URL,"AddExternalFolderItems");var k={theContentItems:g};EPWebServices.doWebServiceCall(h,k,j,i,l)};EPWebServices.FolderWebService.RemoveExternalFolderItem=function(h,k,j,g){var i=EPWebServices.buildURL(this._SERVICE_URL,"RemoveExternalFolderItem");var l={theContentItems:h};EPWebServices.doWebServiceCall(i,l,k,j,g)};EPWebServices.FolderWebService.FolderItemsRefresh=function(m,p,q,l){var k=EPWebServices.buildURL(this._SERVICE_URL,"FolderItemsRefresh");var s={theSessionParams:m};var r=window.panelLoadState||{};if(r.right){ep.showPanel("rightCollapsible","PanelContainer")}else{var t=getElementById("rightCollapsiblePostBack");if(t){var n=/javascript:\s*__doPostBack\s*\(\s*'([^']+)/;var o=n.exec(t.href);if(o){__doPostBack(o[1],"")}}}EPWebServices.doWebServiceCall(k,s,p,q,l)};EPWebServices.FolderWebService.FolderReadNote=function(k,j,m,l,h){var i=EPWebServices.buildURL(this._SERVICE_URL,"FolderReadNote");var n={theSessionParams:k,theContentItem:j};EPWebServices.doWebServiceCall(i,n,m,l,h)};EPWebServices.FolderWebService.FolderPageNoteAdd=function(n,o,p,s,k,q,r,m){var l=EPWebServices.buildURL(this._SERVICE_URL,"FolderPageNoteAdd");var t={theSessionParams:n,theContentItem:o,theIsRefreshFolderItems:p,theIsArticleNote:s,theIsInViewer:k};EPWebServices.doWebServiceCall(l,t,q,r,m)};EPWebServices.FolderWebService.FolderPageNoteDelete=function(m,n,o,j,p,q,k){var l=EPWebServices.buildURL(this._SERVICE_URL,"FolderPageNoteDelete");var r={theSessionParams:m,theContentItem:n,theIsRefreshFolderItems:o,theIsInViewer:j};EPWebServices.doWebServiceCall(l,r,p,q,k)};EPWebServices.FolderWebService.FolderPageNoteUpdate=function(l,m,n,j,o,q,k){var p=EPWebServices.buildURL(this._SERVICE_URL,"FolderPageNoteUpdate");var r={theSessionParams:l,theContentItem:m,theIsRefreshFolderItems:n,theIsInViewer:j};EPWebServices.doWebServiceCall(p,r,o,q,k)};